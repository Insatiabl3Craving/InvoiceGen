<UserControl x:Class="InvoiceGenerator.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="900">
    <ScrollViewer>
        <StackPanel Margin="20" Background="White">
            <TextBlock Text="Settings" FontSize="24" FontWeight="Bold" Margin="0,0,0,30"/>

            <!-- File Settings -->
            <TextBlock Text="File Settings" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>
            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Word Template Path:" VerticalAlignment="Center"/>
                <TextBox Name="TemplatePath" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
                <Button Name="BrowseTemplateBtn" Grid.Column="2" Content="Browse" Click="BrowseTemplateBtn_Click"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Invoices Folder:" VerticalAlignment="Center"/>
                <TextBox Name="InvoicesFolderPath" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
                <Button Name="BrowseFolderBtn" Grid.Column="2" Content="Browse" Click="BrowseFolderBtn_Click"/>
            </Grid>

            <!-- Email Settings -->
            <Separator Margin="0,20,0,20"/>
            <TextBlock Text="Email Settings" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="SMTP Server:" VerticalAlignment="Center"/>
                <TextBox Name="SmtpServer" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="SMTP Port:" VerticalAlignment="Center"/>
                <TextBox Name="SmtpPort" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" Text="587" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="From Email Address:" VerticalAlignment="Center"/>
                <TextBox Name="FromEmail" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Email Password:" VerticalAlignment="Center"/>
                <PasswordBox Name="EmailPassword" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center" PasswordChanged="EmailPassword_PasswordChanged"/>
            </Grid>

            <TextBlock Name="PasswordStatusText" Margin="260,0,0,15" FontSize="12" Foreground="#666666" Text="No Email password"/>

            <CheckBox Name="UseTlsCheckBox" Content="Use TLS" Margin="0,0,0,15" IsChecked="True"/>

            <Button Name="TestEmailBtn" Content="Test Email Connection" Width="200" Padding="10" Click="TestEmailBtn_Click" Margin="0,0,0,15" HorizontalAlignment="Left"/>

            <!-- Email Template Settings -->
            <Separator Margin="0,20,0,20"/>
            <TextBlock Text="Email Template" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

            <Grid Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Default Subject:" VerticalAlignment="Center"/>
                <TextBox Name="DefaultSubject" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Default Body:" VerticalAlignment="Top" Margin="0,5,0,0"/>
                <TextBox Name="DefaultBody" Grid.Column="1" Height="100" Padding="10" Margin="10,0" AcceptsReturn="True" TextWrapping="Wrap"/>
            </Grid>

            <!-- App Password Settings -->
            <Separator Margin="0,20,0,20"/>
            <TextBlock Text="App Password" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

            <Grid Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Current Password:" VerticalAlignment="Center"/>
                <PasswordBox Name="CurrentAppPassword" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="New Password:" VerticalAlignment="Center"/>
                <PasswordBox Name="NewAppPassword" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Confirm New Password:" VerticalAlignment="Center"/>
                <PasswordBox Name="ConfirmAppPassword" Grid.Column="1" Height="38" Padding="10,6" Margin="10,0" VerticalContentAlignment="Center"/>
            </Grid>

            <Button Name="ChangeAppPasswordBtn" Content="Change App Password" Width="200" Padding="10" Click="ChangeAppPasswordBtn_Click" Margin="0,0,0,20"/>

            <!-- Save Button -->
            <Button Name="SaveSettingsBtn" Content="Save Settings" Width="150" Padding="10" Click="SaveSettingsBtn_Click" Background="#007ACC" Foreground="White"/>
        </StackPanel>
    </ScrollViewer>
</UserControl>
